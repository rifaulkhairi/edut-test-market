import{r as m,j as e,y as H}from"./app-Y8fBfMZs.js";import{E as O}from"./EndExamModal-Cbg0HxJe.js";import{T as Q}from"./Timer-CukPjhTB.js";import{d as R,e as U}from"./index-CAKqQOEl.js";import"./Modal-HlqBTzN1.js";import"./iconBase-DK_xsFNO.js";import"./ownerWindow-1SRb00m4.js";import"./useSlotProps-CAAdliou.js";import"./Box-B0zA7AMO.js";import"./Typography-Bn1kZTH6.js";const V=({paketsoal:h,groupedQuestions:d,tipetestData:y,percobaanujian:w,groupedAnswers:N})=>{const[l,v]=m.useState("1"),[i,j]=m.useState(d[l]),[r,x]=m.useState(0),[p,C]=m.useState(Object.keys(d).map(s=>{const t=d[s]||[],o=N[s]||[],a=t.map((n,c)=>{const f=o.find(u=>u.question_id===n.id);return{id:n.id,answer:f?f.answer:null}});return{tipetest:s,questions:a}})),[A,b]=m.useState(!1);m.useEffect(()=>{j(d[l]||[])},[l,d]);const k=async(s,t)=>{C(o=>{const a=o.map(n=>{if(n.tipetest===l){const c=i[r];if(!c)return console.error("Question is undefined."),n;const f=n.questions.map(u=>u.id===c.id?{...u,answer:s}:u);return{...n,questions:f}}return n});return console.log("Updated Answers:",a),S(a,t),a})},S=async(s,t)=>{const a=s.find(n=>n.tipetest===l).questions.find(n=>n.id===i[r].id);if(a&&a.answer!=null)try{const n=i[r].tipe_soal;console.log("Tipe Soal:",n);const c=await axios.post("/api/save-answer",{tipesoal:n,question_id:i[r].id,answer:a.answer,option_id:t,percobaan_id:w.id});console.log("Jawaban disimpan",c.data)}catch(n){console.error("Error menyimpan jawaban",n)}else console.error("Selected question or answer is undefined.")},T=async()=>{r<i.length-1&&x(r+1)},E=()=>{r>0&&x(r-1)},_=()=>{b(!0)},q=()=>{b(!1)},g=()=>{b(!1),H.post("/endexam",{percobaan_id:w.id,paketsoal_id:w.paketsoal_id})},M=s=>{x(s)},I=(s,t)=>{v(s),j(d[s]),x(0)};m.useEffect(()=>{console.log(p)},[p]);const G=()=>{let s;return s=p.filter(t=>t.tipetest===l)[0].questions.filter(t=>t.id===i[r].id)[0].answer,s};return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex w-full absolute h-32 bg-secondary rounded-b-[100px]"}),e.jsxs("div",{className:"max-w-7xl flex m-auto",children:[e.jsxs("div",{className:"relative contsoal flex-1 p-10 rounded-xl shadow-xl bg-white mt-14",children:[e.jsxs("h2",{className:"font-semibold",children:["Soal Nomor ",r+1]}),e.jsx("h5",{className:"soal my-5",dangerouslySetInnerHTML:{__html:i[r].question}}),e.jsxs("div",{className:"pilihan h-auto",children:[e.jsx("ul",{className:"space-y-2",children:i[r].options.map((s,t)=>e.jsxs("li",{className:`h-auto w-full p-2 rounded-lg cursor-pointer flex items-center gap-x-3 ${G()===s.Alias?"bg-secondary text-white":"bg-blue-gray-200/30"}`,onClick:()=>k(s.Alias,s.id),children:[e.jsx("p",{children:`${String.fromCharCode(97+parseInt(s.Alias,10)).toUpperCase()}.`}),e.jsx("p",{dangerouslySetInnerHTML:{__html:s.option}})]},s.Alias))}),e.jsxs("div",{className:"navigasi flex gap-2 mt-20",children:[e.jsx("div",{className:"",children:e.jsxs("button",{onClick:E,disabled:r===0,className:"h-fit w-fit px-3 rounded-md py-2 flex flex-row items-center gap-x-1 bg-green-800/25 text-gray-900",children:[e.jsx(R,{}),"Sebelumnya"]})}),e.jsx("div",{className:"flex",children:e.jsxs("button",{onClick:T,className:"h-fit w-fit px-3 rounded-md py-2 flex flex-row items-center gap-x-1 bg-green-600 text-white",disabled:r===i.length-1,children:[e.jsx("p",{children:"Selanjutnya"}),e.jsx(U,{})]})})]})]})]}),e.jsxs("div",{className:"relative z-30 sisikanan w-autoflex min-w-72 flex-col pt-0 px-4 pb-4 mt-14",children:[e.jsx(Q,{initialHours:h.jam,initialMinutes:h.menit,initialSeconds:h.detik,onTimeUp:g}),e.jsx("div",{className:"akhiri py-2 bg-yellow-900 text-white m-2 rounded-full cursor-pointer hover:shadow-md flex items-center justify-center font-bold",children:e.jsx("button",{onClick:_,children:"AKHIRI UJIAN"})}),e.jsx("div",{className:"tipe shadow-xl rounded-2xl bg-white",children:e.jsxs("div",{className:"tes m-4 grid gap-1 py-4",children:[e.jsx("h1",{className:"font-bold",children:"Pilih Tipe tes"}),Object.keys(d).map((s,t)=>e.jsx("button",{className:`twk p-2 ${s===l?"bg-secondary text-white":"bg-blue-gray-200/30 text-gray-900"} text-md flex justify-between items-center  rounded-lg `,onClick:()=>I(s),children:y.find(o=>o.id===parseInt(s,10)).name},t))]})}),e.jsxs("div",{className:"daftar p-4 bg-white rounded-2xl shadow-xl",children:[e.jsx("h1",{className:"font-bold ",children:"Daftar Soal"}),e.jsx("div",{className:"bks grid grid-cols-5 gap-1",children:Array.from({length:i.length},(s,t)=>{const o=p.find(n=>n.tipetest===l),a=()=>{if(!o)return!1;const n=o.questions.find(c=>c.id===i[t].id);return n&&n.answer!==null};return e.jsx("button",{className:`number-div p-2 hover:scale-110 ${a()?"bg-green-500":"bg-red-500"} text-center rounded-md`,onClick:()=>M(t),children:t+1},t+1)})})]})]}),e.jsx(O,{open:A,onClose:q,onConfirm:g})]})]})};export{V as default};
